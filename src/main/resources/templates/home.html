<!DOCTYPE html>
<html>
	<head>
		<meta charset="ISO-8859-1">
		<title>Home</title>
		<link rel="stylesheet" href="../static/styles.css">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" crossorigin="anonymous">
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" crossorigin="anonymous"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="/webjars/sockjs-client/sockjs.min.js"></script>
		<script src="/webjars/stomp-websocket/stomp.min.js"></script>
		<script	src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
		<script	src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>
		<script type="text/javascript">
			var stompClient;

            function makeDeposit(playerId, deposit) {
                var text = '{"playerId": "'+playerId+'", "deposit": "'+deposit+'", "timestamp": "'+new Date()+'"}';
                stompClient.send("/request/makeDeposit", {priority: 1}, text);
            }

            function loadDepositsAndTotal(){
                stompClient.send("/request/getDepositsList", {priority: 1});
            }

            function loadDepositsAndTotalForPlayer(playerId){
                stompClient.send("/request/getDeposits/player", {priority: 1}, playerId);
            }

			$(document).ready(function() {

				var socket = new SockJS('/connection');
				stompClient = Stomp.over(socket);
				stompClient.connect({}, function(frame) {
					stompClient.subscribe('/topic/deposit.event', function(response) {
                        console.log("Incoming message from topic 'deposit.event' : \n"+response.body);
						var json = JSON.parse(response.body);
						console.log("Json.type : \n\n"+json.type);
						console.log("Json.total : \n\n"+json.total);
						console.log("Json.depositEvents : \n\n"+json.depositEvents);
						// if(json.type != null && json.type=="all"){
						// 	$('#total').text(json.total);
						// }

					});

					loadDepositsAndTotal();
				});

			});
		</script>
	</head>
	<body>
		<div class="container">
			<nav class="navbar navbar-inverse" style="background-color: #343a40 !important;">
				<div class="container-fluid">
					<div class="navbar-header" style="display: flex; flex-direction: row"> 
						<!-- <h2 style="text-decoration: none; color: rgb(162, 162, 162);">Playtech</h2> -->
						<img src="https://www.casinoreviewer.org/wp-content/uploads/2017/04/playtech-550-x-225.jpg" class="logo-img" style="width:30%; height: 100%;"/>
					</div>
	
					<ul class="nav navbar-nav navbar-right">
						<li style="color:whitesmoke" id="connectionStatus"></li>
					</ul>
				</div>
			</nav>
			<div class="jumbotron">
				<h1>Player Deposit Bookeeper App</h1>      
				<p>Bookkepper Notes</p>
			</div>
			<div class="row">
				<div class="col-sm-4">
					<div class="jumbotron" style="height: auto; min-height: 50vh">
						<div class="columnHeaderDiv">
							<h3 class="columnHeader">All Deposits</h3>
						</div>
						<div class="depositList">
							
						</div>
					</div>
				</div>
				<div class="col-sm-4">
					<div class="jumbotron" style="height: auto; min-height: 50vh">
						<div class="columnHeaderDiv">
							<h3 class="columnHeader">
								Player 
								<span>
									<select id="players-filter" class="filterSt"> 
										<option value="">id</option>
									</select>
								</span> 
								Deposits
							</h3>
						</div>
						<div class="depositList">
							
						</div>
					</div>
				</div>
				<div class="col-sm-4">
					<div class="jumbotron" style="height: auto; min-height: 50vh">
						<div class="columnHeaderDiv">
							<h3 class="columnHeader">Make Deposit</h3>
							<!-- <a class="addGlyph"><span class="glyphicon glyphicon-plus" /></a> -->
						</div>
						<div class="depositList">
							
						</div>
					</div>
				</div>
			</div>
		</div>

	</body>
</html>